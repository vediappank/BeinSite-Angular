<kt-portlet>
  <kt-portlet-body style="height: auto;">
    <!-- <h3>
     Call Backs List
   </h3> -->
    <!-- <loading *ngIf="isLoading"></loading> -->
    <div>
      <!-- <kt-progress-bar-spinner [color]="color" [mode]="mode" [value]="value" *ngIf="displayProgressSpinner"
        class="sq-global-backdrop center-aligned">
      </kt-progress-bar-spinner> -->
      <!-- <ng4-loading-spinner> </ng4-loading-spinner> -->
    </div>
    <div class="form-group kt-form__group row">
      <div class="col-lg-2 kt-margin-bottom-20-mobile">
        <mat-form-field class="mat-form-field-fluid">
          <input matInput placeholder="Enter Ticket Id" [(ngModel)]="reportingTicketFilter.TicketId" />
        </mat-form-field>
      </div>
      <div class="col-lg-2 kt-margin-bottom-20-mobile">
        <mat-form-field class="mat-form-field-fluid">
          <mat-select placeholder="Select Ticket Template" [(ngModel)]="reportingTicketFilter.Template">
            <mat-option value="">-NA-</mat-option>
            <mat-option *ngFor="let ccCFTemplate of cfTemplateList" value="{{ccCFTemplate.id}}">
              {{ccCFTemplate.value}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col-lg-2 kt-margin-bottom-20-mobile">
        <mat-form-field class="mat-form-field-fluid">
          <mat-select placeholder="Select Priority" [(ngModel)]="reportingTicketFilter.Priority">
            <mat-option value="">-NA-</mat-option>
            <mat-option *ngFor="let c of ticketPriority" value="{{c.id}}">{{c.name}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col-lg-2 kt-margin-bottom-20-mobile" style="text-align: right;">
        <mat-form-field class="mat-form-field-fluid">
          <mat-select placeholder="Select Status" [(ngModel)]="reportingTicketFilter.Status">
            <mat-option value="">-NA-</mat-option>
            <mat-option *ngFor="let c of ticketStatus" value="{{c.id}}">{{c.name}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="col-lg-4 kt-margin-bottom-20-mobile" style="text-align: right;">

       <!-- <button type="button" mat-raised-button color="primary" (click)="loadReportingTickets(pagenumber,pagesize)"
          matTooltip="Filter" style="width: 80px; padding: 0px 8px;">
          <mat-icon style="width: 15px;padding-right: 15px;height: 16px;">search</mat-icon> Search
        </button> &nbsp;
        <button type="button" mat-raised-button color="primary" (click)="clearFilter()" matTooltip="Clear"
          style="width: 70px;padding: 0px 8px;">
          <mat-icon style="width: 15px;height: 16px;">clear_all</mat-icon>  Clear
        </button> &nbsp;
        <button class="btn btn-primary text-right" (click)="addTicket()" mat-raised-button color="primary" matTooltip="Add"
          disabled="{{addFlag}}" style="width: 60px;padding: 0px 8px;">
          <mat-icon style="width: 13px;height: 16px;">add</mat-icon> Add
        </button> -->

        <button type="button" mat-raised-button color="primary" (click)="loadReportingTickets(pagenumber,pagesize)" style="width: 15%; padding: 0px 8px;"
          matTooltip="Filter">
          <mat-icon style="width: 15px;height: 16px;">search</mat-icon> Search
        </button> &nbsp;

        <button type="button" mat-raised-button color="primary" (click)="clearFilter()" matTooltip="Clear" style="width: 12%; padding: 0px 8px;" >
          <mat-icon style="width: 15px;height: 16px;">clear_all</mat-icon> Clear
        </button> &nbsp;

        <button class="btn btn-primary text-right" (click)="addTicket()" mat-raised-button color="primary"
          matTooltip="Add" disabled="{{addFlag}}" style="width: 11%;padding: 0px 8px;">
          <mat-icon style="width: 13px;height: 16px;">add</mat-icon> Add
        </button>&nbsp;

        <button type="button" mat-raised-button color="primary" (click)="RefreshTickets()" matTooltip="Refresh" style="width: 16%; padding: 0px 8px;">
          <mat-icon style="width: 15px;height: 16px;">refresh</mat-icon> Refresh
        </button> &nbsp;

      </div>
    </div>
    <div class="form-group kt-form__group row">
      <div class="col-lg-12 kt-margin-bottom-20-mobile">
        <div>
          <span class="label" style="font-weight: bold;">Page Size :</span>&nbsp;
          <input placeholder="Page Size" style="width: 45px;" [(ngModel)]="pagesize" (blur)="onChange()"> &nbsp;
          <span class="label" style="font-weight: bold;">Current Page :</span>&nbsp;
          <span class="value" id="lblCurrentPage">-&nbsp;</span> &nbsp;

          <span class="label" style="font-weight: bold;">Total Records :</span>&nbsp;
          <label class="value">{{totalRecords}}</label>
        </div>
      </div>
    </div>
    <div class="form-group kt-form__group row">
      <div class="col-lg-12 kt-margin-bottom-20-mobile">
        <mat-table class="lmat-elevation-z8" #table [dataSource]="TicketList$ | async" matSort
          (matSortChange)="sortData($event)">
          <ng-container matColumnDef="Id">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> ID </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let event"> {{event.id}} 
              <mat-icon *ngIf="event.updated_at > event.ack_at"> star </mat-icon>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="Template">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> Template
            </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let template"> {{template.custom_fields.cf_template}} </mat-cell>
          </ng-container>
          <ng-container matColumnDef="Category">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> Category
            </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let Template">
              <span *ngIf="Template.template=='Reporting'"> {{ Template.custom_fields.reporting_escalation_categorize
                }}</span>
              <span *ngIf="Template.template=='WFO'">{{ Template.custom_fields.cf_wfo_category }} </span>
            </mat-cell>

          </ng-container>
          <ng-container matColumnDef="SubCategory">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> Sub Category
            </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let Template">
              <span *ngIf="Template.template=='Reporting'">{{ Template.custom_fields.subcategory }} </span>
              <span *ngIf="Template.template=='WFO'">{{ Template.custom_fields.cf_wfo_sub }}</span>
            </mat-cell>


          </ng-container>
          <ng-container matColumnDef="Item">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> Item
            </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let Template">
              <span *ngIf="Template.template=='Reporting'"> {{ Template.custom_fields.items }}</span>
              <span *ngIf="Template.template=='WFO'">{{ Template.custom_fields.cf_wfo_items }} </span>
            </mat-cell>

          </ng-container>

          <ng-container matColumnDef="Priority">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> Priority
            </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let priority"> {{ priority.priorityname }} </mat-cell>
          </ng-container>
          <ng-container matColumnDef="Subject">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> Subject
            </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let Subject"> {{Subject.subject}} </mat-cell>
          </ng-container>
          <ng-container matColumnDef="Status">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> Status
            </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let event"> {{event.statusname}} </mat-cell>
          </ng-container>
          <ng-container matColumnDef="Created_At">
            <mat-header-cell mat-header-cell mat-sort-header *matHeaderCellDef class="GridHeader"> Created Date
            </mat-header-cell>
            <mat-cell mat-cell *matCellDef="let event"> {{ event.created_at | date :'dd-MM-yyyy hh:mm:ss' }} </mat-cell>
          </ng-container>

         
          <ng-container matColumnDef="Action">
            <mat-header-cell *matHeaderCellDef class="GridHeader">Actions</mat-header-cell>
            <mat-cell *matCellDef="let action">
              <!-- <button mat-icon-button color="primary" *ngIf="action.Status==5" matTooltip="Edit Call Backs" type="button"
               (click)="EditEvent(action)">
               <mat-icon>create</mat-icon>
             </button> -->
              <button mat-icon-button color="primary" matTooltip="View Ticket Details" type="button"
                (click)="ViewTicket(action)">
                <mat-icon>remove_red_eye</mat-icon>
              </button>
              <button mat-icon-button color="primary" matTooltip="Add Reply" class="matbuttonsize"
                (click)="addTicketReply(action)">
                <mat-icon>chat</mat-icon>
              </button>&nbsp;
              <!-- <button mat-icon-button color="primary" matTooltip="Delete Call Backs" type="button" [hidden]='true'
               (click)="deleteEvent(action)">
               <mat-icon>delete</mat-icon>
             </button> -->

            </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="displayedColumns" class="header"></mat-header-row>

          <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>

        </mat-table>

      </div>
      <div class="col-lg-11 mat-table__bottom" style="text-align: right;margin-top: 2%;">
        <!-- MATERIAL SPINNER | Url: 'https://material.angular.io/components/progress-spinner/overview' -->
        <!-- <mat-spinner [diameter]="20" *ngIf="dataSource.loading$ | async"></mat-spinner> -->
        <!-- MATERIAL PAGINATOR | Binded to dasources -->
        <!-- See off.documentations 'https://material.angular.io/components/paginator/overview' -->
        <!-- <mat-paginator [pageSize]="10" [pageSizeOptions]="[10, 25, 50, 100, 200, 500]" [length]="dataSource.paginatorTotal$ | async" [showFirstLastButtons]="true"></mat-paginator> -->

        <button class="btn btn-primary btn-sm" (click)="onBtFirst()">To First</button>&nbsp;
        <button class="btn btn-primary btn-sm" (click)="onBtPrevious()">To Previous</button>&nbsp;
        <button class="btn btn-primary btn-sm" (click)="onBtNext()">To Next</button>&nbsp;
        <button class="btn btn-primary btn-sm" (click)="onBtLast()" id="btLast">To Last</button>
      </div>
    </div>

  </kt-portlet-body>
  <!-- </div> -->
</kt-portlet>